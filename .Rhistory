Country.name.vec <- toupper(c('Cuba','Dominican Republic','Jamaica','Puerto Rico',
'Trinidad and Tobago','Costa Rica','El Salvador','Guatemala',
'Honduras','Mexico','Nicaragua','Panama','Argentina',
'Chile','Colombia','Ecuador','Paraguay','Peru','Uruguay','Venezuela',
'Haiti','Bolivia','Brazil', 'Latin America'))
# Create a vector with the countries' codes according to WHO
Country.code.vec <- c(2150,2170,2290,2380,2440,2140,2190,2250,2280,2310,
2340,2350,2020,2120,2130,2180,2360,2370,2460,2470,2270,2060,2070,9999)
names(Country.code.vec) <- Country.name.vec
Country.code.vec
Country.name.vec <- toupper(c('Cuba','Dominican Republic','Jamaica','Puerto Rico',
'Trinidad and Tobago','Costa Rica','El Salvador','Guatemala',
'Honduras','Mexico','Nicaragua','Panama','Argentina',
'Chile','Colombia','Ecuador','Paraguay','Peru','Uruguay','Venezuela',
'Haiti','Bolivia','Brazil', 'Latin America'))
# Create a vector with the countries' codes according to WHO
Country.code.vec <- c(2150,2170,2290,2380,2440,2140,2190,2250,2280,2310,
2340,2350,2020,2120,2130,2180,2360,2370,2460,2470,2270,2060,2070,9999)
names(Country.code.vec) <- Country.name.vec
Country.code.vec
# Create a vector with the countries we are interested in
Country.name.vec <- toupper(c('Cuba','Dominican Republic','Jamaica','Puerto Rico',
'Trinidad and Tobago','Costa Rica','El Salvador','Guatemala',
'Honduras','Mexico','Nicaragua','Panama','Argentina',
'Chile','Colombia','Ecuador','Paraguay','Peru','Uruguay','Venezuela',
'Haiti','Bolivia','Brazil', 'Latin America'))
# Create a vector with the countries' codes according to WHO
Country.code.vec <- c(2150,2170,2290,2380,2440,2140,2190,2250,2280,2310,
2340,2350,2020,2120,2130,2180,2360,2370,2460,2470,2270,2060,2070,9999)
names(Country.code.vec) <- Country.name.vec
Country.code.vec
# Create a vector with the countries we are interested in
Country.name.vec <- toupper(c('Cuba','Dominican Republic','Jamaica','Puerto Rico',
'Trinidad and Tobago','Costa Rica','El Salvador','Guatemala',
'Honduras','Mexico','Nicaragua','Panama','Argentina',
'Chile','Colombia','Ecuador','Paraguay','Peru','Uruguay','Venezuela',
'Haiti','Bolivia','Brazil', 'Latin America'))
# Create a vector with the countries' codes according to WHO
Country.code.vec <- c(2150,2170,2290,2380,2440,2140,2190,2250,2280,2310,
2340,2350,2020,2120,2130,2180,2360,2370,2460,2470,2270,2060,2070,9999)
names(Country.code.vec) <- Country.name.vec
Country.code.vec
qpois(p = .5,lambda = .7)
sidebarPanel
library(shiny)
library(data.table)
library(DT)
names.c <- toupper(c('Dominican Republic', 'Costa Rica','El Salvador', 'Guatemala','Mexico', 'Nicaragua',
'Argentina', 'Chile', 'Colombia', 'Ecuador', 'Paraguay',
'Peru', 'Uruguay', 'Venezuela', 'Brazil', 'Cuba','Honduras','Panama','Jamaica'))
Sources <- c('CEPAL2004','CEPAL2010','UN')
Periods <- c("1990-1995", "1995-2000" ,"2000-2005" ,"2005-2010")
sidebarPanel
load('Decomp_results.RData')
setwd("C:/Users/jmaburto/Documents/GitHub/CoD-burden-on-LA/R/Decomp2_App/")
library(shiny)
library(ggplot2)
#rsconnect::setAccountInfo(name='jmaburto',
#                          token='7310E08D0D081D3C3CABCAA90D18045E',
#                          secret='Vzlie6RN39/THGhWKatGf/C68yZp+RENdTdOl/ey')
rsconnect::setAccountInfo(name='wb-lac',
token='06E52479A00F914E6EE44A17FFEA7E80',
secret='D7wg0N0miuHwY8reIRkCRy38E+TSCGXy+nHgm+KH')
load('Decomp_results.RData')
library(ggplot2)
library(data.table)
load('Decomp_results.RData')
setwd("C:/Users/jmaburto/Documents/GitHub/CoD-burden-on-LA/R/Decomp2_App/")
exit
library(plotly)
shiny::runApp('GitHub/CoD-burden-on-LA/R/ex_App')
runApp('GitHub/CoD-burden-on-LA/R/ex_App')
runApp('GitHub/CoD-burden-on-LA/R/ex_App')
runApp('GitHub/CoD-burden-on-LA/R/ex_App')
runApp('GitHub/CoD-burden-on-LA/R/ex_App')
devtools::install_github("mpascariu/MortalityLaws")
devtools::install_github("mpascariu/MortalityLaws")
library(MortalityLaws)
availableHMD()
getwd()
library(ggplot2)
library(data.table)
library(reshape2)
library(RColorBrewer)
setwd("C:/Users/jmaburto/Documents/GitHub/Lifespan-inequality-Denmark")
#2  Cancer, amenable to smoking
#3  Cancer, not amenable to smoking
#5  Cardiovascular & Diabetes mellitus (move to 5)
#6  Respiratory, infectious
#7  Respiratory, non-infectious
#8  External
#9  Other & Infectious, non-respiratory
load('Data/Results.RData')
Decomp.ex  <- local(get(load("Data/DecompResults_ex_List.RData")))
Decomp.cv  <- local(get(load("Data/DecompResults_cv_List.RData")))
Compare.ex <- local(get(load("Data/Compare_DecompResults_ex_List.RData")))
Compare.cv <- local(get(load("Data/Compare_DecompResults_cv_List.RData")))
Labels.periods            <- c('1960-1975','1975-1995','1995-2014')
DT.Decomp.ex$Period     <- (cut(DT.Decomp.ex$Year+1, breaks=c(1960,1975,1995,Inf),labels=Labels.periods))
DT.Decomp.cv$Period     <- (cut(DT.Decomp.cv$Year+1, breaks=c(1960,1975,1995,Inf),labels=Labels.periods))
DT.Decomp.ex            <- DT.Decomp.ex[,list(Contribution = sum(Contribution)), by = list(Sex,Country,Period,Cause,Age)]
DT.Decomp.cv            <- DT.Decomp.cv[,list(Contribution = sum(Contribution)), by = list(Sex,Country,Period,Cause,Age)]
base2 <- c(rev(brewer.pal(8,name = 'Spectral'))[1:5],rev(brewer.pal(8,name = 'Spectral'))[8],'lightgrey','lightpink')
r <- ggplot(DT.compare.ex[DT.compare.ex$Country=='Denmark' & DT.compare.ex$Year == 2014,], aes(x = Age, y = Contribution, fill = Cause)) +
ggtitle('A Decomposition of life expectancy', subtitle = 'Sweden - Denmark, 2014')+
facet_wrap(~Sex)+
scale_fill_manual('Cause of death', values = base2) +
geom_bar(stat = "identity",position = "stack")+
theme_light()+
theme(text = element_text(size=10),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Years",size=10)+
theme(text = element_text(size=10),
strip.text.x = element_text(size = 10, colour = "black"))+
theme(legend.text=element_text(size=10), legend.title = element_text(size=10),
legend.position = c(0.9, 0.18))+
geom_hline(yintercept = 0)+
coord_flip()
r
s <- ggplot(DT.compare.cv[DT.compare.cv$Country=='Denmark' & DT.compare.cv$Year == 2014,], aes(x = Age, y = Contribution, fill = Cause)) +
ggtitle('B Decomposition of lifespan inequality (CoV)', subtitle = 'Danish females. Negative (positive) values decrease (increase) CoV')+
facet_wrap(~Period)+
scale_fill_manual('Cause of death', values = base2) +
geom_bar(stat = "identity",position = "stack", show.legend = F)+
theme_light()+
theme(text = element_text(size=10),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Units",size=10)+
theme(text = element_text(size=10),
strip.text.x = element_text(size = 10, colour = "black"))+
theme(legend.text=element_text(size=10), legend.title = element_text(size=10),
legend.position = c(0.93, 0.25))+
geom_hline(yintercept = 0)+
coord_flip()
s
s <- ggplot(DT.compare.cv[DT.compare.cv$Country=='Denmark' & DT.compare.cv$Year == 2014,], aes(x = Age, y = Contribution, fill = Cause)) +
ggtitle('B Decomposition of lifespan inequality (CoV)', subtitle = 'Danish females. Negative (positive) values decrease (increase) CoV')+
facet_wrap(~Sex)+
scale_fill_manual('Cause of death', values = base2) +
geom_bar(stat = "identity",position = "stack", show.legend = F)+
theme_light()+
theme(text = element_text(size=10),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Units",size=10)+
theme(text = element_text(size=10),
strip.text.x = element_text(size = 10, colour = "black"))+
theme(legend.text=element_text(size=10), legend.title = element_text(size=10),
legend.position = c(0.93, 0.25))+
geom_hline(yintercept = 0)+
coord_flip()
s
s <- ggplot(DT.compare.cv[DT.compare.cv$Country=='Denmark' & DT.compare.cv$Year == 2014,], aes(x = Age, y = -Contribution, fill = Cause)) +
ggtitle('B Decomposition of lifespan inequality (CoV)', subtitle = 'Danish females. Negative (positive) values decrease (increase) CoV')+
facet_wrap(~Sex)+
scale_fill_manual('Cause of death', values = base2) +
geom_bar(stat = "identity",position = "stack", show.legend = F)+
theme_light()+
theme(text = element_text(size=10),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Units",size=10)+
theme(text = element_text(size=10),
strip.text.x = element_text(size = 10, colour = "black"))+
theme(legend.text=element_text(size=10), legend.title = element_text(size=10),
legend.position = c(0.93, 0.25))+
geom_hline(yintercept = 0)+
coord_flip()
s
r <- ggplot(DT.compare.ex[DT.compare.ex$Country=='Denmark' & DT.compare.ex$Year == 2014,], aes(x = Age, y = Contribution, fill = Cause)) +
ggtitle('A Decomposition of life expectancy', subtitle = 'Sweden - Denmark, 2014. Negative (positive) values decrease (increase) the gap in life expectancy with Sweden.')+
facet_wrap(~Sex)+
scale_fill_manual('Cause of death', values = base2) +
geom_bar(stat = "identity",position = "stack")+
theme_light()+
theme(text = element_text(size=10),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Years",size=10)+
theme(text = element_text(size=10),
strip.text.x = element_text(size = 10, colour = "black"))+
theme(legend.text=element_text(size=10), legend.title = element_text(size=10),
legend.position = c(0.9, 0.18))+
geom_hline(yintercept = 0)+
coord_flip()
r
require(gridExtra)
pdf(file="R/Figures/DK_Compare.pdf",width=12,height=11,pointsize=4,useDingbats = F)
grid.arrange(p,q,nrow=2)
dev.off()
require(gridExtra)
pdf(file="R/Figures/DK_Compare.pdf",width=12,height=11,pointsize=4,useDingbats = F)
grid.arrange(r,s,nrow=2)
dev.off()
require(gridExtra)
pdf(file="R/Figures/DK_Compare.pdf",width=10,height=10,pointsize=4,useDingbats = F)
grid.arrange(r,s,nrow=2)
dev.off()
r <- ggplot(DT.compare.ex[DT.compare.ex$Country=='Denmark' & DT.compare.ex$Year == 2014,], aes(x = Age, y = Contribution, fill = Cause)) +
ggtitle('A Decomposition of life expectancy', subtitle = 'Sweden - Denmark, 2014. Negative (positive) values decrease (increase) the gap in life expectancy with Sweden.')+
facet_wrap(~Sex)+
scale_fill_manual('Cause of death', values = base2) +
geom_bar(stat = "identity",position = "stack")+
theme_light()+
theme(text = element_text(size=10),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Years",size=10)+
theme(text = element_text(size=10),
strip.text.x = element_text(size = 10, colour = "black"))+
theme(legend.text=element_text(size=9), legend.title = element_text(size=9),
legend.position = c(0.9, 0.18))+
geom_hline(yintercept = 0)+
coord_flip()
r
s <- ggplot(DT.compare.cv[DT.compare.cv$Country=='Denmark' & DT.compare.cv$Year == 2014,], aes(x = Age, y = -Contribution, fill = Cause)) +
ggtitle('B Decomposition of lifespan inequality (CoV)', subtitle = 'Denmark - Sweden, 2014. Negative (positive) values decrease (increase) the gap in CoV with Sweden.')+
facet_wrap(~Sex)+
scale_fill_manual('Cause of death', values = base2) +
geom_bar(stat = "identity",position = "stack", show.legend = F)+
theme_light()+
theme(text = element_text(size=10),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Units",size=10)+
theme(text = element_text(size=10),
strip.text.x = element_text(size = 10, colour = "black"))+
theme(legend.text=element_text(size=10), legend.title = element_text(size=10),
legend.position = c(0.93, 0.25))+
geom_hline(yintercept = 0)+
coord_flip()
s
require(gridExtra)
pdf(file="R/Figures/DK_Compare.pdf",width=10,height=10,pointsize=4,useDingbats = F)
grid.arrange(r,s,nrow=2)
dev.off()
r <- ggplot(DT.compare.ex[DT.compare.ex$Country=='Denmark' & DT.compare.ex$Year == 2014,], aes(x = Age, y = Contribution, fill = Cause)) +
ggtitle('A Decomposition of life expectancy', subtitle = 'Sweden - Denmark, 2014. Negative (positive) values decrease (increase) the gap in life expectancy with Sweden.')+
facet_wrap(~Sex)+
scale_fill_manual('Cause of death', values = base2) +
geom_bar(stat = "identity",position = "stack")+
theme_light()+
theme(text = element_text(size=10),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Years",size=10)+
theme(text = element_text(size=10),
strip.text.x = element_text(size = 10, colour = "black"))+
theme(legend.text=element_text(size=9), legend.title = element_text(size=9),
legend.position = c(0.4, 0.18))+
geom_hline(yintercept = 0)+
coord_flip()
r
s <- ggplot(DT.compare.cv[DT.compare.cv$Country=='Denmark' & DT.compare.cv$Year == 2014,], aes(x = Age, y = -Contribution, fill = Cause)) +
ggtitle('B Decomposition of lifespan inequality (CoV)', subtitle = 'Denmark - Sweden, 2014. Negative (positive) values decrease (increase) the gap in CoV with Sweden.')+
facet_wrap(~Sex)+
scale_fill_manual('Cause of death', values = base2) +
geom_bar(stat = "identity",position = "stack", show.legend = F)+
theme_light()+
theme(text = element_text(size=10),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Units",size=10)+
theme(text = element_text(size=10),
strip.text.x = element_text(size = 10, colour = "black"))+
theme(legend.text=element_text(size=10), legend.title = element_text(size=10),
legend.position = c(0.93, 0.25))+
geom_hline(yintercept = 0)+
coord_flip()
s
require(gridExtra)
pdf(file="R/Figures/DK_Compare.pdf",width=10,height=10,pointsize=4,useDingbats = F)
grid.arrange(r,s,nrow=2)
dev.off()
r <- ggplot(DT.compare.ex[DT.compare.ex$Country=='Denmark' & DT.compare.ex$Year == 2014,], aes(x = Age, y = Contribution, fill = Cause)) +
ggtitle('A Decomposition of life expectancy', subtitle = 'Sweden - Denmark, 2014. Negative (positive) values decrease (increase) the gap in life expectancy with Sweden.')+
facet_wrap(~Sex)+
scale_fill_manual('Cause of death', values = base2) +
geom_bar(stat = "identity",position = "stack")+
theme_light()+
theme(text = element_text(size=10),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Years",size=10)+
theme(text = element_text(size=10),
strip.text.x = element_text(size = 10, colour = "black"))+
theme(legend.text=element_text(size=9), legend.title = element_text(size=9),
legend.position = c(0.39, 0.18))+
geom_hline(yintercept = 0)+
coord_flip()
r
s <- ggplot(DT.compare.cv[DT.compare.cv$Country=='Denmark' & DT.compare.cv$Year == 2014,], aes(x = Age, y = -Contribution, fill = Cause)) +
ggtitle('B Decomposition of lifespan inequality (CoV)', subtitle = 'Denmark - Sweden, 2014. Negative (positive) values decrease (increase) the gap in CoV with Sweden.')+
facet_wrap(~Sex)+
scale_fill_manual('Cause of death', values = base2) +
geom_bar(stat = "identity",position = "stack", show.legend = F)+
theme_light()+
theme(text = element_text(size=10),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Units",size=10)+
theme(text = element_text(size=10),
strip.text.x = element_text(size = 10, colour = "black"))+
theme(legend.text=element_text(size=10), legend.title = element_text(size=10),
legend.position = c(0.93, 0.25))+
geom_hline(yintercept = 0)+
coord_flip()
s
require(gridExtra)
pdf(file="R/Figures/DK_Compare.pdf",width=10,height=10,pointsize=4,useDingbats = F)
grid.arrange(r,s,nrow=2)
dev.off()
Data2014 <- DT.compare.ex[DT.compare.ex$Year == 2014,]
Data2014ex <- DT.compare.ex[DT.compare.ex$Year == 2014,]
Data2014cv <- DT.compare.cv[DT.compare.cv$Year == 2014,]
Data2014ex$ind <- 'ex'
Data2014cv$ind <- 'cv'
Data2014 <- rbind(Data2014ex,Data2014cv)
Data2014 <- Data4[Data$Country == 'Denmark',]
Data2014 <- Data2014[Data2014$Country == 'Denmark',]
table1 <- Data2014[, sum(Contribution), by = list(Sex,Cause,ind)]
table1
table1 <- Data2014[, sum(Contribution), by = list(Cause,Sex,ind)]
table1
table1 <- Data2014[, sum(Contribution), by = list(Sex,Cause,ind)]
table1
save(table1,file = 'Table1.cvs')
save(table1,file = 'R/Figures/Table1.cvs')
write.csv(table1,file = 'R/Figures/Table1.cvs')
Data2014ex <- DT.compare.ex[DT.compare.ex$Year == 2014,]
Data2014ex$ind <- 'ex'
Data2014cv <- DT.compare.cv[DT.compare.cv$Year == 2014,]
Data2014cv$ind <- 'cv'
Data2014ex <- DT.compare.ex[DT.compare.ex$Year == 2014,]
Data2014ex$ind <- 'ex'
Data2014cv <- DT.compare.cv[DT.compare.cv$Year == 2014,]
Data2014cv$ind <- 'cv'
Data2014 <- rbind(Data2014ex,Data2014cv)
Data2014 <- Data2014[Data2014$Country == 'Denmark',]
table1 <- Data2014[, sum(Contribution), by = list(Sex,Age,Cause,ind)]
table1
write.csv(table1,file = 'R/Figures/Table1.cvs')
table1 <- Data2014[, sum(Contribution), by = list(Sex,Cause,ind)]
table1
write.csv(table1,file = 'R/Figures/Table1.cvs')
Data2014[, sum(Contribution), by = list(Sex,Age,ind)]
lambda <- 10^seq(-2,7, .25)
lambda
