theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))
p
q <-ggplot(Data, aes(x = Year,y = cv,colour=PopName)) +
ggtitle('B Lifespan inequality') +
geom_line(aes(group = PopName), size= 1.2) +
facet_wrap(~Sex2)+
theme_light()+
labs(y = "Years")+
scale_colour_manual('Country', values = c('red','blue','green'), labels = c('Denmark','Norway', 'Sweden')) +
theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))
q
require(gridExtra)
pdf(file="R/Figures/Trends.pdf",width=15,height=8,pointsize=4,useDingbats = F)
grid.arrange(p,q,ncol=2)
dev.off()
require(gridExtra)
pdf(file="R/Figures/Trends.pdf",width=15,height=8,pointsize=4,useDingbats = F)
grid.arrange(p,q,nrow=2)
dev.off()
require(gridExtra)
pdf(file="R/Figures/Trends.pdf",width=10,height=5,pointsize=4,useDingbats = F)
grid.arrange(p,q,nrow=2)
dev.off()
require(gridExtra)
pdf(file="R/Figures/Trends.pdf",width=8,height=8,pointsize=4,useDingbats = F)
grid.arrange(p,q,nrow=2)
dev.off()
p <-ggplot(Data, aes(x = Year,y = ex,colour=PopName)) +
ggtitle('A Life expectancy at birth') +
geom_line(aes(group = PopName), size= 1.2) +
facet_wrap(~Sex2)+
theme_light()+
labs(y = "Years")+
scale_colour_manual('Country', values = c('red','blue','green'), labels = c('Denmark','Norway', 'Sweden')) +
theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))
p
q <-ggplot(Data, aes(x = Year,y = cv,colour=PopName)) +
ggtitle('B Lifespan inequality') +
geom_line(aes(group = PopName), size= 1.2) +
facet_wrap(~Sex2)+
theme_light()+
labs(y = "Years")+
scale_colour_manual('Country', values = c('red','blue','green'), labels = c('Denmark','Norway', 'Sweden')) +
theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))
q
require(gridExtra)
pdf(file="R/Figures/Trends.pdf",width=8,height=8,pointsize=4,useDingbats = F)
grid.arrange(p,q,nrow=2)
dev.off()
library(ggplot2)
library(data.table)
library(reshape2)
setwd("C:/Users/jmaburto/Documents/GitHub/Lifespan-inequality-Denmark")
library(ggplot2)
library(data.table)
library(reshape2)
setwd("C:/Users/jmaburto/Documents/GitHub/Lifespan-inequality-Denmark")
HMD <- get(load('Data/HMD_Data.RData'))
## subset the countries that I am interested in
unique(HMD$PopName)
Countries <- c('DNK', 'SWE', 'NOR')
Data <- HMD[HMD$PopName %in% Countries,]
gdata::keep(Data,Countries,sure=T)
source('R/Functions_1.R')
get(load('Data/DT_COD.RData'))
View(DT_COD.melt)
DKN <- read.table('Data/DK_Mx_5x1.txt')
DKN <- read.table('Data/DK_Mx_5x1.txt')
DKN <- read.table('Data/DK_Mx_5x1.txt',header = T)
View(DKN)
DKN <- read.table('Data/DK_Mx_5x1.txt',header = T,stringsAsFactors = F)
DKN <- read.table('Data/DK_Mx_5x1.txt',header = T,stringsAsFactors = F)
DKN <- read.table('Data/DK_Mx_5x1.txt',header = T,stringsAsFactors = F)
DKN <- data.table(DKN)
mx  <- DKN[DKN$Year >= 1960,c(Year,mx)]
mx
mx  <- DKN[DKN$Year >= 1960,c(''Year',mx')]
mx  <- DKN[DKN$Year >= 1960,c('Year','mx')]
COD <- DT_COD.melt[DT_COD.melt$Year >= 1960 & DT_COD.melt$Country =='Denmark' & DT_COD.melt$Sex=='f', ]
COD
COD <- DT_COD.melt[DT_COD.melt$Year >= 1960 & DT_COD.melt$Country.name =='Denmark' & DT_COD.melt$Sex=='f', ]
COD
unique(DT_COD.melt$Age)
DKN <- read.table('Data/DK_Mx_5x1.txt',header = T,stringsAsFactors = F)
DKN <- data.table(DKN)
mx  <- DKN[DKN$Year >= 1960,c('Year','Age', 'mx')]
mx
COD <- DT_COD.melt[DT_COD.melt$Year >= 1960 & DT_COD.melt$Country.name =='Denmark' & DT_COD.melt$Sex=='f', ]
unique(DT_COD.melt$Age)
unique(mx$Age)
unique(DT_COD.melt$Year)
unique(mx$Year)
COD <- DT_COD.melt[DT_COD.melt$Year >= 1960 & DT_COD.melt$Year <= 2014 & DT_COD.melt$Country.name =='Denmark' & DT_COD.melt$Sex=='f', ]
COD
unique(DT_COD.melt$Age)
unique(DT_COD.melt$Year)
unique(mx$Age)
unique(mx$Year)
Years <- unique(mx$Year)
i <- 1960
mx1 <- mx[mx$Year == i,]$mx
mx1
mx[mx$Year == i,]
mx[mx$Year==1960]
mx[Year==1960,]
mx1 <- mx[Year==1960,]
mx1 <- mx[Year==i,]
mx2 <- mx[Year==i+1,]
mx2
COD1 <- COD[COD$Year == i,]
COD1
COD2 <- COD[COD$Year == i+1,]
COD2
acast(data = COD1,formula = Cat ~ Age,value.var = Dx.p)
acast(data = COD1,formula = Cat ~ Age,value.var = 'Dx.p')
acast(data = COD1,formula = Age ~ Cat,value.var = 'Dx.p')
unique(DT_COD.melt$Age)
unique(mx$Age)
m0 <- matrix(0,6,8)
m0
m0 <- cbind(m0,1)
m0
seq(85,110,5)
rownames(m0) <- seq(85,110,5)
m1 <- rbind(m1,m0)
m1 <- acast(data = COD1,formula = Age ~ Cat,value.var = 'Dx.p')
m1
m1 <- rbind(m1,m0)
m1
m2 <- acast(data = COD2,formula = Age ~ Cat,value.var = 'Dx.p')
m2
m2 <- rbind(m2,m0)
m2
m1 <- m1*mx1
m1 <- m1*mx1$mx
m2 <- m2*mx2$mx
rowSums(m1)-mx1$mx
e0frommxc <- function(mxcvec,sex){
dim(mxcvec) <- c(24,length(mxcvec)/24)
mx          <- rowSums(mxcvec)
LifeExpectancy(mx,sex)
}
cvfrommxc <- function(mxcvec,sex){
dim(mxcvec) <- c(24,length(mxcvec)/24)
mx          <- rowSums(mxcvec)
cvfrommxc(mx,sex)
}
cvfrommxc(m1,sex = 'f')
m1
mxcvec = m1
c(24,length(mxcvec)/24)
c(m1)
mxcvec = c(m1)
dim(mxcvec) <- c(24,length(mxcvec)/24)
mxcvec
mx          <- rowSums(mxcvec)
mx
cvfrommxc(mx,sex)
mx
sex='f'
i.openage <- length(mx)
OPENAGE   <- i.openage - 1
RADIX     <- 1
ax        <- mx * 0 + .5
ax[1]     <- AKm02a0(m0 = mx[1], sex = sex)
qx        <- mx / (1 + (1 - ax) * mx)
qx[i.openage]       <- ifelse(is.na(qx[i.openage]), NA, 1)
ax[i.openage]       <- 1 / mx[i.openage]
px 				    <- 1 - qx
px[is.nan(px)]      <- 0
lx 			        <- c(RADIX, RADIX * cumprod(px[1:OPENAGE]))
dx 				    <- lx * qx
Lx 				    <- lx - (1 - ax) * dx
Lx[i.openage ]	    <- lx[i.openage ] * ax[i.openage ]
Tx 				    <- c(rev(cumsum(rev(Lx[1:OPENAGE]))),0) + Lx[i.openage]
ex 				    <- Tx / lx
age           <- 0:(i.openage-1)
vx <- sum(dx*(age+ax-ex[1L])^2)
cv <- sqrt(vx)/ex[1L]
return(cv)
cv
cvfrommxc <- function(mxcvec = c(m1),sex){
dim(mxcvec) <- c(24,length(mxcvec)/24)
mx          <- rowSums(mxcvec)
cv.frommx(mx,sex)
}
mx
cv.frommx(mx,sex)
Contribution <- Decomp(cvfrommxc,rates1 = c(m1), rates2 = c(m2), N = 50, sex = 'f')
Contribution
dim(Contribution) <- dim(m1)
Contribution
Results <- NULL
m1
melt(Contribution,varnames = c('Age', 'Cause'), value.name = 'Contribution')
rownames(m1)
rownames(Contribution) <- rownames(m1)
melt(Contribution,varnames = c('Age', 'Cause'), value.name = 'Contribution')
R1 <- melt(Contribution,varnames = c('Age', 'Cause'), value.name = 'Contribution')
R1$Year <- i
Results <- rbind(Results, R1)
Results
Results <- NULL
Years
Years[-length(Years)]
for (i in Years[-length(Years)]){
mx1 <- mx[Year==i,]
mx2 <- mx[Year==i+1,]
COD1 <- COD[COD$Year == i,]
COD2 <- COD[COD$Year == i+1,]
m0 <- matrix(0,6,8)
m0 <- cbind(m0,1)
rownames(m0) <- seq(85,110,5)
m1 <- acast(data = COD1,formula = Age ~ Cat,value.var = 'Dx.p')
m1 <- rbind(m1,m0)
m2 <- acast(data = COD2,formula = Age ~ Cat,value.var = 'Dx.p')
m2 <- rbind(m2,m0)
m1 <- m1*mx1$mx
m2 <- m2*mx2$mx
Contribution <- Decomp(cvfrommxc,rates1 = c(m1), rates2 = c(m2), N = 50, sex = 'f')
dim(Contribution) <- dim(m1)
rownames(Contribution) <- rownames(m1)
R1 <- melt(Contribution,varnames = c('Age', 'Cause'), value.name = 'Contribution')
R1$Year <- i
Results <- rbind(Results, R1)
}
i <- 1960
mx1 <- mx[Year==i,]
mx2 <- mx[Year==i+1,]
mx1 <- mx[mx$Year==i,]
DKN <- read.table('Data/DK_Mx_5x1.txt',header = T,stringsAsFactors = F)
DKN <- data.table(DKN)
mx  <- DKN[DKN$Year >= 1960,c('Year','Age', 'mx')]
COD <- DT_COD.melt[DT_COD.melt$Year >= 1960 & DT_COD.melt$Year <= 2014 & DT_COD.melt$Country.name =='Denmark' & DT_COD.melt$Sex=='f', ]
unique(DT_COD.melt$Age)
unique(DT_COD.melt$Year)
unique(mx$Age)
Years <- unique(mx$Year)
Results <- NULL
mx
Years
for (i in Years[-length(Years)]){
mx1 <- mx[Year==i,]
mx2 <- mx[Year==i+1,]
COD1 <- COD[COD$Year == i,]
COD2 <- COD[COD$Year == i+1,]
m0 <- matrix(0,6,8)
m0 <- cbind(m0,1)
rownames(m0) <- seq(85,110,5)
m1 <- acast(data = COD1,formula = Age ~ Cat,value.var = 'Dx.p')
m1 <- rbind(m1,m0)
m2 <- acast(data = COD2,formula = Age ~ Cat,value.var = 'Dx.p')
m2 <- rbind(m2,m0)
m1 <- m1*mx1$mx
m2 <- m2*mx2$mx
Contribution <- Decomp(cvfrommxc,rates1 = c(m1), rates2 = c(m2), N = 50, sex = 'f')
dim(Contribution) <- dim(m1)
rownames(Contribution) <- rownames(m1)
R1 <- melt(Contribution,varnames = c('Age', 'Cause'), value.name = 'Contribution')
R1$Year <- i
Results <- rbind(Results, R1)
}
View(Results)
Results$Cause <- as.factor(Results$Cause)
Results
levels(Results$Cause)
levels(Results$Cause) <- Category.labels
Results$Cause
Results$Period <- cut(Results$Year+1, breaks = c(1960,1975,1995,Inf), labels = c('1960-1975',
'1975-1995',
'1995-2013'))
Results <- data.table(Results)
Results2 <- Results[, sum(Contribution), by = list(Period,Age,Cause)]
save(Results, file = 'Data/Resuls_PAA.RData')
cause.lab
display.brewer.all()
base2 <- c(1:15)
base2 <- c(rev(brewer.pal(8,name = 'Spectral'))[1:5],rev(brewer.pal(8,name = 'Spectral'))[8],rev(brewer.pal(8,name = 'Spectral'))[7],'lightgrey')
library(RColorBrewer)
display.brewer.all()
base2 <- c(1:15)
base2 <- c(rev(brewer.pal(8,name = 'Spectral'))[1:5],rev(brewer.pal(8,name = 'Spectral'))[8],rev(brewer.pal(8,name = 'Spectral'))[7],'lightgrey')
base2
base2 <- c(rev(brewer.pal(8,name = 'Spectral'))[1:5],rev(brewer.pal(8,name = 'Spectral'))[8],rev(brewer.pal(8,name = 'Spectral'))[7],'green', 'lightgrey')
ggplot(Data.fig, aes(x = Age, y = V1, fill = Cause)) +
ggtitle('Contributions to changes in lifespan inequality by age and cause of death' )+
scale_fill_manual(name= ' Cause of death (Contribution)',values=base2,labels = Category.labels)+
geom_bar(aes(group = Cause), stat = "identity",position = "stack")+
theme_light()+
facet_wrap(~Period)
ggplot(Results2, aes(x = Age, y = V1, fill = Cause)) +
ggtitle('Contributions to changes in lifespan inequality by age and cause of death' )+
scale_fill_manual(name= ' Cause of death (Contribution)',values=base2,labels = Category.labels)+
geom_bar(aes(group = Cause), stat = "identity",position = "stack")+
theme_light()+
facet_wrap(~Period)
ggplot(Results2, aes(x = Age, y = V1, fill = Cause)) +
ggtitle('Contributions to changes in lifespan inequality by age and cause of death' )+
scale_fill_manual(name= ' Cause of death (Contribution)',values=base2,labels = Category.labels)+
geom_bar(aes(group = Cause), stat = "identity",position = "stack")+
theme_light()+
facet_wrap(~Period)+
theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Contribution (years)",size=12)
ggplot(Results2, aes(x = Age, y = V1, fill = Cause)) +
ggtitle('Contributions to changes in lifespan inequality by age and cause of death' )+
scale_fill_manual(name= ' Cause of death (Contribution)',values=base2,labels = Category.labels)+
geom_bar(aes(group = Cause), stat = "identity",position = "stack")+
theme_light()+
facet_wrap(~Period)+
theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Contribution (years)",size=12)+
theme(axis.title.y = element_text(size = 12, angle = 90))+
theme(axis.title.x = element_text(size = 12, angle = 00))+
theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))+
theme(legend.position = c(.75,.75))+
annotate("text", x=-Inf, y=-Inf,hjust=1,vjust=1, label= text.1,size=6) +
geom_hline(yintercept = 0)+coord_flip()
f1 <- ggplot(Results2, aes(x = Age, y = V1, fill = Cause)) +
ggtitle('Contributions to changes in lifespan inequality by age and cause of death' )+
scale_fill_manual(name= ' Cause of death (Contribution)',values=base2,labels = Category.labels)+
geom_bar(aes(group = Cause), stat = "identity",position = "stack")+
theme_light()+
facet_wrap(~Period)+
theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Contribution (years)",size=12)+
theme(axis.title.y = element_text(size = 12, angle = 90))+
theme(axis.title.x = element_text(size = 12, angle = 00))+
theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))+
theme(legend.position = c(.75,.75))+
geom_hline(yintercept = 0)+coord_flip()
f1
f1 <- ggplot(Results2, aes(x = factor(Age), y = V1, fill = Cause)) +
ggtitle('Contributions to changes in lifespan inequality by age and cause of death' )+
scale_fill_manual(name= ' Cause of death (Contribution)',values=base2,labels = Category.labels)+
geom_bar(aes(group = Cause), stat = "identity",position = "stack")+
theme_light()+
facet_wrap(~Period)+
theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Contribution (years)",size=12)+
theme(axis.title.y = element_text(size = 12, angle = 90))+
theme(axis.title.x = element_text(size = 12, angle = 00))+
theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))+
theme(legend.position = c(.75,.75))+
geom_hline(yintercept = 0)+coord_flip()
f1
f1 <- ggplot(Results2[Results2$Age!=0], aes(x = factor(Age), y = V1, fill = Cause)) +
ggtitle('Contributions to changes in lifespan inequality by age and cause of death' )+
scale_fill_manual(name= ' Cause of death (Contribution)',values=base2,labels = Category.labels)+
geom_bar(aes(group = Cause), stat = "identity",position = "stack")+
theme_light()+
facet_wrap(~Period)+
theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Contribution (years)",size=12)+
theme(axis.title.y = element_text(size = 12, angle = 90))+
theme(axis.title.x = element_text(size = 12, angle = 00))+
theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))+
theme(legend.position = c(.75,.75))+
geom_hline(yintercept = 0)+coord_flip()
f1
base3 <- c(base2[5],base2[6],base2[7],base2[8],base2[4],base2[1],base2[2],base2[3],base2[9])
f1 <- ggplot(Results2[Results2$Age!=0], aes(x = factor(Age), y = V1, fill = Cause)) +
ggtitle('Contributions to changes in lifespan inequality by age and cause of death' )+
scale_fill_manual(name= ' Cause of death (Contribution)',values=base3,labels = Category.labels)+
geom_bar(aes(group = Cause), stat = "identity",position = "stack")+
theme_light()+
facet_wrap(~Period)+
theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Contribution (years)",size=12)+
theme(axis.title.y = element_text(size = 12, angle = 90))+
theme(axis.title.x = element_text(size = 12, angle = 00))+
theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))+
theme(legend.position = c(.75,.75))+
geom_hline(yintercept = 0)+coord_flip()
f1
f1 <- ggplot(Results2[Results2$Age!=0], aes(x = factor(Age), y = V1, fill = Cause)) +
ggtitle('Contributions to changes in lifespan inequality by age and cause of death' )+
#scale_fill_manual(name= ' Cause of death (Contribution)',values=base3,labels = Category.labels)+
geom_bar(aes(group = Cause), stat = "identity",position = "stack")+
theme_light()+
facet_wrap(~Period)+
theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Contribution (years)",size=12)+
theme(axis.title.y = element_text(size = 12, angle = 90))+
theme(axis.title.x = element_text(size = 12, angle = 00))+
theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))+
theme(legend.position = c(.75,.75))+
geom_hline(yintercept = 0)+coord_flip()
f1
f1 <- ggplot(Results2[Results2$Age!=0], aes(x = factor(Age), y = V1, fill = Cause)) +
ggtitle('Contributions to changes in lifespan inequality by age and cause of death' )+
scale_fill_manual(name= ' Cause of death (Contribution)',values=base3,labels = Category.labels)+
geom_bar(aes(group = Cause), stat = "identity",position = "stack")+
theme_light()+
facet_wrap(~Period)+
theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Contribution (years)",size=12)+
theme(axis.title.y = element_text(size = 12, angle = 90))+
theme(axis.title.x = element_text(size = 12, angle = 00))+
theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))+
theme(legend.position = c(.75,.75))+
geom_hline(yintercept = 0)+coord_flip()
f1
require(gridExtra)
pdf(file="R/Figures/Decomp.pdf",width=8,height=8,pointsize=4,useDingbats = F)
f1
dev.off()
pdf(file="R/Figures/Decomp.pdf",width=15,height=6,pointsize=4,useDingbats = F)
f1
dev.off()
f1 <- ggplot(Results2[Results2$Age!=0], aes(x = factor(Age), y = V1, fill = Cause)) +
ggtitle('Contributions to changes in lifespan inequality by age and cause of death' )+
scale_fill_manual(name= ' Cause of death (Contribution)',values=base3,labels = Category.labels)+
geom_bar(aes(group = Cause), stat = "identity",position = "stack")+
theme_light()+
facet_wrap(~Period)+
theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Contribution (years)",size=12)+
theme(axis.title.y = element_text(size = 12, angle = 90))+
theme(axis.title.x = element_text(size = 12, angle = 00))+
theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))+
theme(legend.position = c(.75,.2))+
geom_hline(yintercept = 0)+coord_flip()
f1
require(gridExtra)
pdf(file="R/Figures/Decomp.pdf",width=18,height=8,pointsize=4,useDingbats = F)
f1
dev.off()
f1 <- ggplot(Results2[Results2$Age!=0], aes(x = factor(Age), y = V1, fill = Cause)) +
ggtitle('Contributions to changes in lifespan inequality by age and cause of death' )+
scale_fill_manual(name= ' Cause of death (Contribution)',values=base3,labels = Category.labels)+
geom_bar(aes(group = Cause), stat = "identity",position = "stack")+
theme_light()+
facet_wrap(~Period)+
theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Contribution (years)",size=12)+
theme(axis.title.y = element_text(size = 12, angle = 90))+
theme(axis.title.x = element_text(size = 12, angle = 00))+
theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))+
theme(legend.position = c(.75,.2))+
geom_hline(yintercept = 0)+coord_flip()
f1
require(gridExtra)
pdf(file="R/Figures/Decomp.pdf",width=18,height=8,pointsize=4,useDingbats = F)
f1
dev.off()
f1 <- ggplot(Results2[Results2$Age!=0], aes(x = factor(Age), y = V1, fill = Cause)) +
ggtitle('Contributions to changes in lifespan inequality by age and cause of death' )+
scale_fill_manual(name= ' Cause of death (Contribution)',values=base3,labels = Category.labels)+
geom_bar(aes(group = Cause), stat = "identity",position = "stack")+
theme_light()+
facet_wrap(~Period)+
theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Contribution (years)",size=12)+
theme(axis.title.y = element_text(size = 12, angle = 90))+
theme(axis.title.x = element_text(size = 12, angle = 00))+
theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))+
theme(legend.position = c(.75,.15))+
geom_hline(yintercept = 0)+coord_flip()
f1
require(gridExtra)
pdf(file="R/Figures/Decomp.pdf",width=18,height=8,pointsize=4,useDingbats = F)
f1
dev.off()
Category.labels
Category.labels2 <-c("Infectious, non-Respiratory", "Cancer-Amenable to Smoking", "Cancer-Non amenable","Diabetes","Cardiovascular","Respiratory-Infectious",
"Respiratory-Non infectious","External","Rest")
f1 <- ggplot(Results2[Results2$Age!=0], aes(x = factor(Age), y = V1, fill = Cause)) +
ggtitle('Contributions to changes in lifespan inequality by age and cause of death' )+
scale_fill_manual(name= ' Cause of death (Contribution)',values=base3,labels = Category.labels2)+
geom_bar(aes(group = Cause), stat = "identity",position = "stack")+
theme_light()+
facet_wrap(~Period)+
theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))+
labs(x = "Age group", y = "Contribution (years)",size=12)+
theme(axis.title.y = element_text(size = 12, angle = 90))+
theme(axis.title.x = element_text(size = 12, angle = 00))+
theme(text = element_text(size=14),
strip.text.x = element_text(size = 14, colour = "black"))+
theme(legend.position = c(.75,.15))+
geom_hline(yintercept = 0)+coord_flip()
f1
require(gridExtra)
pdf(file="R/Figures/Decomp.pdf",width=18,height=8,pointsize=4,useDingbats = F)
f1
dev.off()
